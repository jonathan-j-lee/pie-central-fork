<!DOCTYPE html>
<html >
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
      <title>runtime.api</title>
    
          <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
          <link rel="stylesheet" href="../../_static/theme.css " type="text/css" />
          <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
      
      <!-- sphinx script_files -->
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>

      
      <!-- bundled in js (rollup iife) -->
      <!-- <script src="../../_static/theme-vendors.js"></script> -->
      <script src="../../_static/theme.js" defer></script>
    
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" /> 
  </head>

  <body>
    <div id="app">
    <div class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="../../index.html" class="home-link">
    
      <span class="site-name">Runtime</span>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">



    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            



            
          </navlinks><div id="searchbox" class="searchbox" role="search">
  <div class="caption"><span class="caption-text">Quick search</span>
    <div class="searchformwrapper">
      <form class="search" action="../../search.html" method="get">
        <input type="text" name="q" />
        <input type="submit" value="Search" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../../index.html#runtime-documentation">Contents:</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 ">
            
              <a href="../../design.html" class="reference internal ">Design Goals</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="../../architecture.html" class="reference internal ">Architecture</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="../../ipc.html" class="reference internal ">IPC</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="../../smart-devices.html" class="reference internal ">Smart Devices</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="../../api-reference/index.html" class="reference internal ">API Reference</a>
            

            
          </li>

        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
    
      <li><a href="../index.html">Module code</a> &raquo;</li>
    
    <li>runtime.api</li>
  </ul>
  

  <ul class="page-nav">
</ul>
  
</div>
<hr>
          <div class="content" role="main" v-pre>
            
  <h1>Source code for runtime.api</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Student API for controlling the robot.</span>

<span class="sd">The student provides a single Python file containing a minimum of four functions:</span>

<span class="sd">    &gt;&gt;&gt; def autonomous_setup():</span>
<span class="sd">    ...     ...</span>
<span class="sd">    &gt;&gt;&gt; def autonomous_main():</span>
<span class="sd">    ...     ...</span>
<span class="sd">    &gt;&gt;&gt; def teleop_setup():</span>
<span class="sd">    ...     ...</span>
<span class="sd">    &gt;&gt;&gt; def teleop_main():</span>
<span class="sd">    ...     ...</span>

<span class="sd">The ``*_setup`` functions---``autonomous_setup`` and ``teleop_setup``---run once at the</span>
<span class="sd">start of the autonomous and teleop phases, respectively. After the setup function runs,</span>
<span class="sd">the corresponding ``*_main`` functions run periodically until the end of the phase. The</span>
<span class="sd">frequency of ``main`` calls is configurable, but the default interval is 0.1s.</span>

<span class="sd">These interfaces are largely thin wrappers around :class:`runtime.buffer.BufferStore`.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">import</span> <span class="nn">asyncio</span>
<span class="kn">import</span> <span class="nn">enum</span>
<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span><span class="p">,</span> <span class="n">field</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">Any</span><span class="p">,</span>
    <span class="n">Awaitable</span><span class="p">,</span>
    <span class="n">Callable</span><span class="p">,</span>
    <span class="n">ClassVar</span><span class="p">,</span>
    <span class="n">Mapping</span><span class="p">,</span>
    <span class="n">Optional</span><span class="p">,</span>
    <span class="n">Protocol</span><span class="p">,</span>
    <span class="n">TypeVar</span><span class="p">,</span>
    <span class="n">Union</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">log</span>
<span class="kn">from</span> <span class="nn">.buffer</span> <span class="kn">import</span> <span class="n">Buffer</span><span class="p">,</span> <span class="n">BufferKey</span><span class="p">,</span> <span class="n">BufferStore</span><span class="p">,</span> <span class="n">DeviceBufferError</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Actions&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Alliance&#39;</span><span class="p">,</span>
    <span class="s1">&#39;BufferAPI&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Field&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Gamepad&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Robot&#39;</span><span class="p">,</span>
    <span class="s1">&#39;StudentAPI&#39;</span><span class="p">,</span>
    <span class="s1">&#39;safe&#39;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">Action</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Awaitable</span><span class="p">[</span><span class="kc">None</span><span class="p">]]</span>


<div class="viewcode-block" id="Alliance"><a class="viewcode-back" href="../../api-reference/api.html#runtime.api.Alliance">[docs]</a><span class="nd">@enum</span><span class="o">.</span><span class="n">unique</span>
<span class="k">class</span> <span class="nc">Alliance</span><span class="p">(</span><span class="n">enum</span><span class="o">.</span><span class="n">IntEnum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The alliances that compete in a match.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        BLUE: The blue alliance.</span>
<span class="sd">        GOLD: The gold alliance.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">BLUE</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">GOLD</span> <span class="o">=</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="StudentAPI"><a class="viewcode-back" href="../../api-reference/api.html#runtime.api.StudentAPI">[docs]</a><span class="k">class</span> <span class="nc">StudentAPI</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">ABC</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base type for all student-callable interfaces.&quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="Actions"><a class="viewcode-back" href="../../api-reference/api.html#runtime.api.Actions">[docs]</a><span class="k">class</span> <span class="nc">Actions</span><span class="p">(</span><span class="n">StudentAPI</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;API for performing asynchronous execution.</span>

<span class="sd">    An &quot;action&quot; is a special function defined with the ``async def`` keywords, like so:</span>

<span class="sd">        &gt;&gt;&gt; async def wave_hand():</span>
<span class="sd">        ...     Robot.set(SERVO_UID, &#39;servo0&#39;, -0.5)</span>
<span class="sd">        ...     await Actions.sleep(1)</span>
<span class="sd">        ...     Robot.set(SERVO_UID, &#39;servo0&#39;, 0.5)</span>

<span class="sd">    In this example, the robot&#39;s servo rotates 45 degrees counterclockwise from the</span>
<span class="sd">    motor&#39;s center, waits one second, and then rotates 90 degrees clockwise. Actions are</span>
<span class="sd">    useful for triggering time-sensitive events outside the ``autonomous_main`` or</span>
<span class="sd">    ``teleop_main`` functions, which fire at a fixed frequency.</span>

<span class="sd">    To schedule an action to run, call :meth:`Actions.run` on the action&#39;s name from one</span>
<span class="sd">    of the regular ``*_setup`` or ``*_main`` functions, like so:</span>

<span class="sd">        &gt;&gt;&gt; def autonomous_setup():</span>
<span class="sd">        ...     Actions.run(wave_hand)  # Correct</span>
<span class="sd">        ...     wave_hand()             # Incorrect: will not run</span>

<span class="sd">    Do not call an action like you would call a regular function.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Actions.sleep"><a class="viewcode-back" href="../../api-reference/api.html#runtime.api.Actions.sleep">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">async</span> <span class="k">def</span> <span class="nf">sleep</span><span class="p">(</span><span class="n">duration</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Pause the current action for some amount of time.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            duration: The number of seconds to wait for. Must be a nonnegative number.</span>

<span class="sd">        Note:</span>
<span class="sd">            Remember to use the ``await`` keyword before :meth:`Actions.sleep`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span></div>

<div class="viewcode-block" id="Actions.run"><a class="viewcode-back" href="../../api-reference/api.html#runtime.api.Actions.run">[docs]</a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">action</span><span class="p">:</span> <span class="n">Action</span><span class="p">,</span>
        <span class="o">/</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
        <span class="n">periodic</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Schedule an action to run outside of the ``*_main`` functions.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            action: An action (coroutine function).</span>
<span class="sd">            args: Positional arguments to pass to the action.</span>
<span class="sd">            timeout: Maximum number of seconds the action should be allowed to run for.</span>
<span class="sd">                Must be a nonnegative number.</span>
<span class="sd">            periodic: Whether to run the action repeatedly or not. A periodic action</span>
<span class="sd">                that completes before the timeout has elapsed is not rescheduled early.</span>
<span class="sd">        &quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="Actions.is_running"><a class="viewcode-back" href="../../api-reference/api.html#runtime.api.Actions.is_running">[docs]</a>    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">is_running</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="n">Action</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Check whether an action is already running.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            action: An action (coroutine function).</span>
<span class="sd">        &quot;&quot;&quot;</span></div></div>


<div class="viewcode-block" id="BufferAPI"><a class="viewcode-back" href="../../api-reference/api.html#runtime.api.BufferAPI">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">BufferAPI</span><span class="p">(</span><span class="n">StudentAPI</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base type for all APIs that access shared memory buffers.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        buffers: Buffer store.</span>
<span class="sd">        logger: Synchronous bound logger.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">buffers</span><span class="p">:</span> <span class="n">BufferStore</span>
    <span class="n">logger</span><span class="p">:</span> <span class="n">log</span><span class="o">.</span><span class="n">Logger</span>

    <span class="k">def</span> <span class="nf">_get_default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="n">buf_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffers</span><span class="o">.</span><span class="n">catalog</span><span class="p">[</span><span class="n">type_name</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">buf_type</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">param</span><span class="p">]</span><span class="o">.</span><span class="n">default</span>

    <span class="k">def</span> <span class="nf">_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">BufferKey</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="n">type_name</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffers</span><span class="o">.</span><span class="n">normalize_key</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_default</span><span class="p">(</span><span class="n">type_name</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
        <span class="n">context</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">type_name</span><span class="p">,</span> <span class="s1">&#39;param&#39;</span><span class="p">:</span> <span class="n">param</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">default</span><span class="p">}</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">buffer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffers</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">DeviceBufferError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Device does not exist&#39;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="n">exc</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">default</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">buffer</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">DeviceBufferError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s1">&#39;Unable to get parameter&#39;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="n">exc</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">default</span></div>


<span class="n">RT</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;RT&#39;</span><span class="p">)</span>


<div class="viewcode-block" id="safe"><a class="viewcode-back" href="../../api-reference/api.html#runtime.api.safe">[docs]</a><span class="k">def</span> <span class="nf">safe</span><span class="p">(</span><span class="n">method</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">RT</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RT</span><span class="p">]]:</span>
    <span class="sd">&quot;&quot;&quot;A decorator that wraps API methods to catch and log any exceptions.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        method: API method to be wrapped.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The method wrapper. If the wrapped method raises an :class:`Exception`, the</span>
<span class="sd">        wrapper&#39;s return value will be :data:`None`. :class:`BaseException` is too broad</span>
<span class="sd">        to catch.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">method</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">BufferAPI</span><span class="p">,</span> <span class="o">/</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RT</span><span class="p">]:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>  <span class="c1"># pylint: disable=broad-except; student-facing method</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">method</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">(...) raised an error&#39;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="n">exc</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">wrapper</span></div>


<div class="viewcode-block" id="Robot"><a class="viewcode-back" href="../../api-reference/api.html#runtime.api.Robot">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Robot</span><span class="p">(</span><span class="n">BufferAPI</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;API for accessing Smart Devices.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        names: A mapping from human-readable device names (aliases) to UIDs that</span>
<span class="sd">            students can configure.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">names</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_translate_uid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uid</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">uid</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">uid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">uid</span><span class="p">,</span> <span class="n">uid</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">uid</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DeviceBufferError</span><span class="p">(</span>
                <span class="s1">&#39;UID is neither an integer nor a name&#39;</span><span class="p">,</span>
                <span class="n">names</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">),</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">exc</span>

<div class="viewcode-block" id="Robot.get"><a class="viewcode-back" href="../../api-reference/api.html#runtime.api.Robot.get">[docs]</a>    <span class="nd">@safe</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uid</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get a Smart Device parameter.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            uid: Either a UID as an integer or a device name to be resolved into a UID.</span>
<span class="sd">            param: Parameter name.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The current parameter value. Because written parameters take time to</span>
<span class="sd">            propogate to the device and the device must send an acknowledgement, the</span>
<span class="sd">            current value may not immediately reflect a written value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_translate_uid</span><span class="p">(</span><span class="n">uid</span><span class="p">),</span> <span class="n">param</span><span class="p">)</span></div>

<div class="viewcode-block" id="Robot.write"><a class="viewcode-back" href="../../api-reference/api.html#runtime.api.Robot.write">[docs]</a>    <span class="nd">@safe</span>
    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uid</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Write a Smart Device parameter.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            uid: Either a UID as an integer or a device name to be resolved into a UID.</span>
<span class="sd">            param: Parameter name.</span>
<span class="sd">            value: New parameter value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffers</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_translate_uid</span><span class="p">(</span><span class="n">uid</span><span class="p">)]</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Gamepad"><a class="viewcode-back" href="../../api-reference/api.html#runtime.api.Gamepad">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Gamepad</span><span class="p">(</span><span class="n">BufferAPI</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;API for reading game controller inputs.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        enabled: Whether gamepads are enabled. In autonomous mode, this parameter should</span>
<span class="sd">            be set to :data:`False`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">enabled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">TYPE_NAME</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;gamepad&#39;</span>

<div class="viewcode-block" id="Gamepad.get"><a class="viewcode-back" href="../../api-reference/api.html#runtime.api.Gamepad.get">[docs]</a>    <span class="nd">@safe</span>
    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get a gamepad parameter.</span>

<span class="sd">        Attempting to access a gamepad while it is disabled will emit a warning but</span>
<span class="sd">        will still return a type-safe default value.</span>

<span class="sd">        Parameters:</span>
<span class="sd">            param: Parameter name.</span>
<span class="sd">            index: Gamepad identifier (a nonnegative integer).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">enabled</span><span class="p">:</span>
            <span class="n">default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TYPE_NAME</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s1">&#39;Gamepad is not enabled in autonomous&#39;</span><span class="p">,</span>
                <span class="n">param</span><span class="o">=</span><span class="n">param</span><span class="p">,</span>
                <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">default</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">TYPE_NAME</span><span class="p">,</span> <span class="n">index</span><span class="p">),</span> <span class="n">param</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Field"><a class="viewcode-back" href="../../api-reference/api.html#runtime.api.Field">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Field</span><span class="p">(</span><span class="n">BufferAPI</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;API for interacting with the field and other robots.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        start: The UNIX timestamp (in seconds) of the start of the current</span>
<span class="sd">            autonomous/teleop phase.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">start</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_buffer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Buffer</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">buffers</span><span class="p">[</span><span class="s1">&#39;field&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>  <span class="c1"># type: ignore[misc]</span>
    <span class="nd">@safe</span>
    <span class="k">def</span> <span class="nf">alliance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Alliance</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The alliance this robot is a member of in this match.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Alliance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="o">.</span><span class="n">alliance</span><span class="p">)</span>

<div class="viewcode-block" id="Field.clock"><a class="viewcode-back" href="../../api-reference/api.html#runtime.api.Field.clock">[docs]</a>    <span class="k">def</span> <span class="nf">clock</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The number of seconds since autonomus or teleop started.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span></div>

<div class="viewcode-block" id="Field.send"><a class="viewcode-back" href="../../api-reference/api.html#runtime.api.Field.send">[docs]</a>    <span class="nd">@safe</span>
    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Send a message to an allied robot.&quot;&quot;&quot;</span>
        <span class="o">...</span>  <span class="c1"># TODO</span></div>

<div class="viewcode-block" id="Field.recv"><a class="viewcode-back" href="../../api-reference/api.html#runtime.api.Field.recv">[docs]</a>    <span class="nd">@safe</span>
    <span class="k">def</span> <span class="nf">recv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Receive a message from an allied robot.&quot;&quot;&quot;</span>
        <span class="o">...</span>  <span class="c1"># TODO</span></div></div>


<span class="k">class</span> <span class="nc">StudentCodeModule</span><span class="p">(</span><span class="n">Protocol</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The API symbols made available to the student code module.</span>

<span class="sd">    Note:</span>
<span class="sd">        The :func:`print` function should also be listed, but Mypy does not yet support</span>
<span class="sd">        replacing callables: https://github.com/python/mypy/issues/708</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Alliance</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Alliance</span><span class="p">]</span> <span class="o">=</span> <span class="n">Alliance</span>
    <span class="n">Actions</span><span class="p">:</span> <span class="n">Actions</span>
    <span class="n">Robot</span><span class="p">:</span> <span class="n">Robot</span>
    <span class="n">Gamepad</span><span class="p">:</span> <span class="n">Gamepad</span>
    <span class="n">Field</span><span class="p">:</span> <span class="n">Field</span>
</pre></div>

          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
</ul><div class="footer" role="contentinfo">
      &#169; Copyright 2021, Pioneers in Engineering.
    <br>
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0 with <a href="https://github.com/schettino72/sphinx_press_theme">Press Theme</a> 0.8.0.
</div>
            </div>
          </div>
      </page>
    </div></div>
    
    
  </body>
</html>